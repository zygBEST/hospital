{"remainingRequest":"D:\\My_Project\\毕设项目\\flask+vue医务管理系统\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\My_Project\\毕设项目\\flask+vue医务管理系统\\frontend\\src\\views\\ChatBot.vue?vue&type=style&index=0&id=078caa85&scoped=true&lang=css&","dependencies":[{"path":"D:\\My_Project\\毕设项目\\flask+vue医务管理系统\\frontend\\src\\views\\ChatBot.vue","mtime":1743953677517},{"path":"D:\\My_Project\\毕设项目\\flask+vue医务管理系统\\frontend\\node_modules\\css-loader\\dist\\cjs.js","mtime":1689001367870},{"path":"D:\\My_Project\\毕设项目\\flask+vue医务管理系统\\frontend\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1689001369658},{"path":"D:\\My_Project\\毕设项目\\flask+vue医务管理系统\\frontend\\node_modules\\postcss-loader\\src\\index.js","mtime":1689001368637},{"path":"D:\\My_Project\\毕设项目\\flask+vue医务管理系统\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1689001367240},{"path":"D:\\My_Project\\毕设项目\\flask+vue医务管理系统\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":1689001369023}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KKiB7DQogICAgYm94LXNpemluZzogYm9yZGVyLWJveDsNCn0NCg0KYm9keSB7DQogICAgZm9udC1mYW1pbHk6IEFyaWFsLCBzYW5zLXNlcmlmOw0KICAgIHBhZGRpbmc6IDIwcHg7DQogICAgYmFja2dyb3VuZC1jb2xvcjogI2Y3ZjdmNzsNCiAgICBtYXgtd2lkdGg6IDgwMHB4Ow0KICAgIG1hcmdpbjogMCBhdXRvOw0KfQ0KDQpoMSB7DQogICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgIGZvbnQtc2l6ZTogMnJlbTsNCiAgICBtYXJnaW4tYm90dG9tOiAyMHB4Ow0KfQ0KDQouY2hhdC1jb250YWluZXIgew0KICAgIGJhY2tncm91bmQtY29sb3I6ICNmZmY7DQogICAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICAgIGJveC1zaGFkb3c6IDAgNHB4IDEwcHggcmdiYSgwLCAwLCAwLCAwLjEpOw0KICAgIHBhZGRpbmc6IDIwcHg7DQogICAgbWFyZ2luLWJvdHRvbTogMjBweDsNCiAgICBvdmVyZmxvdy15OiBhdXRvOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICBnYXA6IDEwcHg7DQogICAgcG9zaXRpb246IHJlbGF0aXZlOw0KICAgIC8qIOS/neivgeWuueWZqOWGheeahOWFg+e0oOiDveWumuS9jSAqLw0KfQ0KDQouY2hhdC1tZXNzYWdlIHsNCiAgICBwYWRkaW5nOiAxMHB4Ow0KICAgIGJvcmRlci1yYWRpdXM6IDVweDsNCiAgICBtYXgtd2lkdGg6IDgwJTsNCiAgICB3b3JkLXdyYXA6IGJyZWFrLXdvcmQ7DQp9DQoNCi51c2VyLW1lc3NhZ2Ugew0KICAgIGJhY2tncm91bmQtY29sb3I6ICNlMGY3ZmE7DQogICAgYWxpZ24tc2VsZjogZmxleC1lbmQ7DQp9DQoNCi5haS1tZXNzYWdlIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjFmMWYxOw0KICAgIGFsaWduLXNlbGY6IGZsZXgtc3RhcnQ7DQp9DQoNCmlucHV0LA0KYnV0dG9uIHsNCiAgICBwYWRkaW5nOiAxMHB4Ow0KICAgIGZvbnQtc2l6ZTogMTZweDsNCiAgICBtYXJnaW4tdG9wOiAxMHB4Ow0KICAgIHdpZHRoOiAxMDAlOw0KICAgIGJvcmRlci1yYWRpdXM6IDVweDsNCiAgICBib3JkZXI6IDFweCBzb2xpZCAjY2NjOw0KfQ0KDQpidXR0b24gew0KICAgIGJhY2tncm91bmQtY29sb3I6ICMwMDdCRkY7DQogICAgY29sb3I6IHdoaXRlOw0KICAgIGN1cnNvcjogcG9pbnRlcjsNCn0NCg0KYnV0dG9uOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMDA1NmIzOw0KfQ0KDQoudGhpbmtpbmcgew0KICAgIGZvbnQtc3R5bGU6IGl0YWxpYzsNCiAgICBjb2xvcjogIzk5OTsNCiAgICBkaXNwbGF5OiBub25lOw0KICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgICBib3R0b206IDEwcHg7DQogICAgbWFyZ2luLWJvdHRvbTogMDsNCn0NCg=="},{"version":3,"sources":["ChatBot.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4FA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ChatBot.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n    <div class=\"chat-wrapper\">\r\n        <h1>向AI医生咨询</h1>\r\n        <div class=\"chat-container\" ref=\"chatContainer\">\r\n            <p class=\"thinking\" v-if=\"isThinking\">正在输入...</p>\r\n            <div v-for=\"(msg, index) in messages\" :key=\"index\"\r\n                :class=\"['chat-message', msg.role === 'user' ? 'user-message' : 'ai-message']\">\r\n                {{ msg.content }}\r\n            </div>\r\n        </div>\r\n\r\n        <input v-model=\"question\" @keydown.enter.prevent=\"sendQuestion\" type=\"text\" placeholder=\"请输入您的问题...\" required />\r\n        <button @click=\"sendQuestion\">提交问题</button>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n    name: 'ChatBot',\r\n    data() {\r\n        return {\r\n            question: '',\r\n            messages: [],\r\n            chatHistory: [],\r\n            isThinking: false\r\n        }\r\n    },\r\n    methods: {\r\n        async sendQuestion() {\r\n            const trimmed = this.question.trim()\r\n            if (!trimmed) {\r\n                alert('请输入您的问题！')\r\n                return\r\n            }\r\n\r\n            // 添加用户消息\r\n            this.messages.push({ role: 'user', content: trimmed })\r\n            this.chatHistory.push({ role: 'user', content: trimmed })\r\n            this.question = ''\r\n            this.isThinking = true\r\n\r\n            try {\r\n                const response = await fetch('/chat', {\r\n                    method: 'POST',\r\n                    headers: { 'Content-Type': 'application/json' },\r\n                    body: JSON.stringify({ question: trimmed, history: this.chatHistory })\r\n                })\r\n\r\n                if (!response.ok) throw new Error('HTTP 错误：' + response.status)\r\n\r\n                await this.streamMessage(response)\r\n\r\n            } catch (error) {\r\n                this.isThinking = false\r\n                this.messages.push({ role: 'assistant', content: '请求错误：' + error.message })\r\n            }\r\n        },\r\n        async streamMessage(response) {\r\n            const reader = response.body.getReader()\r\n            const decoder = new TextDecoder('utf-8')\r\n\r\n            let aiMsg = ''\r\n            const newMsg = { role: 'assistant', content: '' }\r\n            this.messages.push(newMsg)\r\n            this.$nextTick(this.scrollToBottom)\r\n\r\n            while (true) {\r\n                const { value, done } = await reader.read()\r\n                if (done) break\r\n\r\n                const text = decoder.decode(value, { stream: true })\r\n                newMsg.content += text\r\n                aiMsg += text\r\n                this.$nextTick(this.scrollToBottom)\r\n            }\r\n\r\n            this.chatHistory.push({ role: 'assistant', content: aiMsg })\r\n            this.isThinking = false\r\n        },\r\n        scrollToBottom() {\r\n            const container = this.$refs.chatContainer\r\n            container.scrollTop = container.scrollHeight\r\n        }\r\n    },\r\n    mounted() {\r\n        this.question = '你是一个AI医生，请你帮助我回答任何医疗问题'\r\n        this.sendQuestion()\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n* {\r\n    box-sizing: border-box;\r\n}\r\n\r\nbody {\r\n    font-family: Arial, sans-serif;\r\n    padding: 20px;\r\n    background-color: #f7f7f7;\r\n    max-width: 800px;\r\n    margin: 0 auto;\r\n}\r\n\r\nh1 {\r\n    text-align: center;\r\n    font-size: 2rem;\r\n    margin-bottom: 20px;\r\n}\r\n\r\n.chat-container {\r\n    background-color: #fff;\r\n    border-radius: 8px;\r\n    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);\r\n    padding: 20px;\r\n    margin-bottom: 20px;\r\n    overflow-y: auto;\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 10px;\r\n    position: relative;\r\n    /* 保证容器内的元素能定位 */\r\n}\r\n\r\n.chat-message {\r\n    padding: 10px;\r\n    border-radius: 5px;\r\n    max-width: 80%;\r\n    word-wrap: break-word;\r\n}\r\n\r\n.user-message {\r\n    background-color: #e0f7fa;\r\n    align-self: flex-end;\r\n}\r\n\r\n.ai-message {\r\n    background-color: #f1f1f1;\r\n    align-self: flex-start;\r\n}\r\n\r\ninput,\r\nbutton {\r\n    padding: 10px;\r\n    font-size: 16px;\r\n    margin-top: 10px;\r\n    width: 100%;\r\n    border-radius: 5px;\r\n    border: 1px solid #ccc;\r\n}\r\n\r\nbutton {\r\n    background-color: #007BFF;\r\n    color: white;\r\n    cursor: pointer;\r\n}\r\n\r\nbutton:hover {\r\n    background-color: #0056b3;\r\n}\r\n\r\n.thinking {\r\n    font-style: italic;\r\n    color: #999;\r\n    display: none;\r\n    position: absolute;\r\n    bottom: 10px;\r\n    margin-bottom: 0;\r\n}\r\n</style>"]}]}